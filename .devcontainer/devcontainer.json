// For format details, see https://aka.ms/devcontainer.json. For config options, see the README at:
// https://github.com/microsoft/vscode-dev-containers/tree/v0.217.4/containers/azure-functions-java-11
{
  "name": "Java",
  // Or use a Dockerfile or Docker Compose file. More info: https://containers.dev/guide/dockerfile
  "build": {
    "dockerfile": "Dockerfile"
  },
  "features": {
    "ghcr.io/devcontainers-community/npm-features/prettier:1": {},
    "ghcr.io/devcontainers-extra/features/curl-apt-get:1": {},
    "ghcr.io/devcontainers-extra/features/json-server:1": {},
    "ghcr.io/devcontainers-extra/features/quarkus-sdkman:2": {},
    "ghcr.io/devcontainers-extra/features/springboot-sdkman:2": {},
    "ghcr.io/devcontainers-extra/features/zsh-plugins:0": {},
    "ghcr.io/devcontainers/features/common-utils:2.5.4": {},
    "ghcr.io/devcontainers/features/docker-outside-of-docker:1": {},
    "ghcr.io/devcontainers/features/java:1": {
      "installMaven": "true",
      "mavenVersion": "3.9.10",
      "installGradle": "true",
      "gradleVersion": "9.2.0"
    }
  },
  "forwardPorts": [
    7071
  ],
  "mounts": [
    "source=localcache,target=/home/vscode/.m2,type=volume"
  ],
  "postCreateCommand": "sudo chown -R vscode.vscode /home/vscode/.m2;mkdir -p /home/vscode/.redhat/; echo '{\"disabled\":true}' > /home/vscode/.redhat/io.quarkus.analytics.localconfig",
  "containerEnv": {
    "DOCKER_NETWORK": "docker-default-network",
    "DB_HOST": "postgres",
    "OTEL_HOST": "grafana-otel-lgtm" },
  // Use 'initializeCommand' to run commands on the host before container gets created.
  "initializeCommand": "touch ${localEnv:HOME}/.vscode/.zsh_history;docker network create docker-default-network || echo Fine. Using existing network.",
  "runArgs": [
    "--network=docker-default-network",
    // change this once you rename the project folder!
    "--hostname=${localWorkspaceFolderBasename}",
    "--add-host=example.localhost.direct:127.0.0.2"
  ],
  // Comment out to connect as root instead. More info: https://aka.ms/vscode-remote/containers/non-root.
  "remoteUser": "vscode",
  "customizations": {
    "vscode": {
      "extensions": [
        "ms-azuretools.vscode-docker",
        "vscjava.vscode-java-pack",
        "esbenp.prettier-vscode",
        "mhutchie.git-graph",
        "donjayamanne.githistory",
        "waderyan.gitblame",
        "SonarSource.sonarlint-vscode",
        "DotJoshJohnson.xml",
        "redhat.vscode-xml",
        "timonwong.shellcheck",
        "Angular.ng-template",
        "redhat.vscode-quarkus",
        "shengchen.vscode-checkstyle",
        "fwcd.kotlin",
        "rhalaly.scope-to-this",
        "yzhang.markdown-all-in-one",
        "redhat.vscode-yaml",
        "jebbs.plantuml",
        "EditorConfig.EditorConfig",
        "tonybaloney.vscode-pets",
        "ms-vscode.live-server",
        "ryanluker.vscode-coverage-gutters",
        "ms-vsliveshare.vsliveshare",
        "myml.vscode-markdown-plantuml-preview",
        "vscjava.vscode-java-test",
        "redhat.java",
        "vstirbu.vscode-mermaid-preview"
      ],
      "settings": {
        "terminal.integrated.defaultProfile.linux": "zsh",
        "terminal.integrated.profiles.linux": {
          "zsh": {
            "path": "zsh"
          }
        }
      }
    }
  }
}